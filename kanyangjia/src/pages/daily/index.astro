---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const title = 'æ¯æ—¥å¤ç›˜ - çœ‹å…»å®¶';
const description = 'äººç”Ÿ4ä¸‡å¤©ï¼Œæ¯æ—¥è®°å½•æˆé•¿';

// è·å–æ‰€æœ‰æ¯æ—¥å¤ç›˜æ–‡ç« ï¼ŒæŒ‰æ—¥æœŸå€’åº
const dailyEntries = await getCollection('daily');
const sortedEntries = dailyEntries.sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

// è·å–æœ€æ–°çš„æ–‡ç« 
const latestEntry = sortedEntries[0];
---

<Layout title={title} description={description}>
  <div style="text-align: center; margin-bottom: 3rem;">
    <h1>ğŸ“… æ¯æ—¥å¤ç›˜</h1>
    <p style="color: var(--color-muted);">äººç”Ÿæ˜¯ä¸€åœºä¿®è¡Œï¼Œæ¯ä¸€å¤©éƒ½ç®—æ•°</p>
  </div>

  <!-- æœ€æ–°å¤ç›˜ -->
  {latestEntry && (
    <section style="padding: 2rem; background: linear-gradient(135deg, var(--color-card), #2a2a2a); border-radius: 12px; margin-bottom: 3rem; border: 1px solid var(--color-border);">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h2 style="margin: 0;">ğŸŒŸ æœ€æ–°å¤ç›˜</h2>
        <span style="font-size: 0.875rem; color: var(--color-muted);">{latestEntry.data.date}</span>
      </div>
      <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
        {latestEntry.data.mood && <span style="font-size: 1.5rem;">{latestEntry.data.mood}</span>}
        <span style="padding: 0.25rem 0.75rem; background: var(--color-accent); color: white; border-radius: 20px; font-size: 0.75rem;">{latestEntry.data.day || 'å‘¨å‡ '}</span>
        {latestEntry.data.tags?.map(tag => (
          <span style="padding: 0.25rem 0.75rem; background: var(--color-border); border-radius: 20px; font-size: 0.75rem;">#{tag}</span>
        ))}
      </div>
      <p style="color: var(--color-muted); margin-bottom: 1rem;">{latestEntry.data.reflection || 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…...'}</p>
      
      {latestEntry.data.completed && latestEntry.data.completed.length > 0 && (
        <div style="margin-bottom: 1rem;">
          <h4 style="font-size: 0.875rem; color: var(--color-muted); margin-bottom: 0.5rem;">âœ… ä»Šæ—¥å®Œæˆ</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            {latestEntry.data.completed.slice(0, 3).map(item => (
              <li style="padding: 0.25rem 0; font-size: 0.875rem;">â€¢ {item}</li>
            ))}
          </ul>
        </div>
      )}
      
      <a href={`/daily/${latestEntry.slug}`} style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--color-accent); color: white; border-radius: 8px; font-weight: 500;">
        æŸ¥çœ‹å®Œæ•´å¤ç›˜ â†’
      </a>
    </section>
  )}

  <!-- å¿«é€Ÿå¯¼èˆª -->
  <div style="display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap;">
    <a href="#entries" style="padding: 0.5rem 1rem; background: var(--color-card); border-radius: 20px; font-size: 0.875rem;">ğŸ“š å†å²è®°å½• ({sortedEntries.length})</a>
    <a href="#system" style="padding: 0.5rem 1rem; background: var(--color-card); border-radius: 20px; font-size: 0.875rem;">ğŸ¯ å¤ç›˜ä½“ç³»</a>
    <a href="#template" style="padding: 0.5rem 1rem; background: var(--color-card); border-radius: 20px; font-size: 0.875rem;">ğŸ“ æ¨¡æ¿å‚è€ƒ</a>
  </div>

  <!-- å¤ç›˜ä½“ç³» -->
  <section id="system" style="margin-bottom: 3rem;">
    <h2 style="margin-bottom: 1.5rem; border-left: 4px solid var(--color-accent); padding-left: 1rem;">ğŸ¯ å¤ç›˜ä½“ç³»</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
      <div style="padding: 1.5rem; background: var(--color-card); border-radius: 8px;">
        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">ğŸŒ…</div>
        <h4>æ¯æ—¥è®¡åˆ’</h4>
        <p style="font-size: 0.875rem; color: var(--color-muted);">THE ONE Â· æ ¸å¿ƒé¡¹ç›® Â· èƒ½é‡æ»‹å…»</p>
      </div>

      <div style="padding: 1.5rem; background: var(--color-card); border-radius: 8px;">
        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">ğŸŒ™</div>
        <h4>æ¯æ—¥è®°å½•</h4>
        <p style="font-size: 0.875rem; color: var(--color-muted);">æˆ˜æœç›˜ç‚¹ Â· æƒ…ç»ªåˆ‡ç‰‡ Â· æ˜æ—¥ä¸€äº‹</p>
      </div>

      <div style="padding: 1.5rem; background: var(--color-card); border-radius: 8px;">
        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">ğŸ“Š</div>
        <h4>äººç”Ÿå‘¨æŠ¥</h4>
        <p style="font-size: 0.875rem; color: var(--color-muted);">å‘¨å›é¡¾ Â· æ•°æ®æ±‡æ€» Â· ä¸‹å‘¨è§„åˆ’</p>
      </div>

      <div style="padding: 1.5rem; background: var(--color-card); border-radius: 8px;">
        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">ğŸ¯</div>
        <h4>å­£åº¦å¤ç›˜</h4>
        <p style="font-size: 0.875rem; color: var(--color-muted);">OKRè¿›åº¦ Â· å¹´åº¦40é—® Â· äººç”Ÿ4ä¸‡å¤©</p>
      </div>
    </div>
  </section>

  <!-- å†å²è®°å½• -->
  <section id="entries" style="margin-bottom: 3rem;">
    <h2 style="margin-bottom: 1.5rem; border-left: 4px solid var(--color-accent); padding-left: 1rem;">ğŸ“š å†å²è®°å½•</h2>
    
    {sortedEntries.length > 0 ? (
      <div style="display: flex; flex-direction: column; gap: 1rem;">
        {sortedEntries.map(entry => (
          <a href={`/daily/${entry.slug}`} style="display: block; padding: 1.5rem; background: var(--color-card); border-radius: 8px; border: 1px solid var(--color-border); text-decoration: none; color: inherit; transition: all 0.2s;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <span style="font-size: 1.25rem;">{entry.data.mood || 'ğŸ“'}</span>
                <span style="font-weight: 500;">{entry.data.title}</span>
              </div>
              <span style="font-size: 0.75rem; color: var(--color-muted);">{entry.data.date}</span>
            </div>
            <p style="color: var(--color-muted); font-size: 0.875rem; margin: 0; line-height: 1.5;">
              {entry.data.reflection || entry.body?.slice(0, 100) + '...' || 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…'}
            </p>
            {entry.data.tags && entry.data.tags.length > 0 && (
              <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem;">
                {entry.data.tags.map(tag => (
                  <span style="padding: 0.125rem 0.5rem; background: var(--color-border); border-radius: 12px; font-size: 0.75rem;">#{tag}</span>
                ))}
              </div>
            )}
          </a>
        ))}
      </div>
    ) : (
      <div style="padding: 2rem; text-align: center; color: var(--color-muted); background: var(--color-card); border-radius: 8px;">
        <p>ğŸ“ æš‚æ— è®°å½•</p>
        <p style="font-size: 0.875rem; margin-top: 0.5rem;">å¼€å§‹æ’°å†™ä½ çš„ç¬¬ä¸€ç¯‡å¤ç›˜å§ï¼</p>
      </div>
    )}
  </section>

  <!-- æ¨¡æ¿è¯´æ˜ -->
  <section id="template" style="margin-bottom: 3rem;">
    <h2 style="margin-bottom: 1.5rem; border-left: 4px solid var(--color-accent); padding-left: 1rem;">ğŸ“ å¤ç›˜æ¨¡æ¿å‚è€ƒ</h2>
    
    <div style="padding: 1.5rem; background: var(--color-card); border-radius: 8px; overflow-x: auto;">
      <pre style="font-family: var(--font-mono); font-size: 0.875rem; line-height: 1.8; color: #ccc;"><code>---
title: "æ¯æ—¥äººç”Ÿå¤ç›˜"
date: "2026-02-06"
day: "å‘¨äº”"
mood: "ğŸ”¥"
tags: ["æ—¥å¸¸", "å¤ç›˜"]
completed:
  - å®Œæˆäº‹é¡¹1
  - å®Œæˆäº‹é¡¹2
reflection: "ä»Šæ—¥åæ€æ‘˜è¦"
tomorrow_plan:
  - æ˜æ—¥è®¡åˆ’1
nourish:
  coffee: "å’–å•¡è®°å½•"
  reading: "é˜…è¯»è®°å½•"
  exercise: "é”»ç‚¼è®°å½•"
---

## ğŸ“ ä»Šæ—¥è®°å½•
...
</code></pre>
    </div>
  </section>

</Layout>

<style>
  a[href^="/daily/"]:hover {
    border-color: var(--color-accent) !important;
    transform: translateY(-2px);
  }
</style>
